// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Guest {
  id  Int    @id @default(autoincrement()) 
  tokenId        Int       @unique 
  host           Int
  flag           String
  collaboratorId String
  //status    Role     @default(GUEST)
  createdAt      DateTime @default(now())
  country        String
  password       String
  onLine         Boolean
  endDate        String
  stages         Stage[]
  sprints        Sprint[]
  favorites        Favorite[]
  @@unique([ country,collaboratorId, onLine])

}
model Favorite {
  id  Int    @id @default(autoincrement()) 
  hostId Int
  guestId Int 
  Guest Guest[]
  
  @@unique([hostId, guestId])
}


model Stage {
  id  Int    @id @default(autoincrement()) 

  stageId     String   @unique
  createdAt   DateTime @default(now())
  souraName   String
  souraNb     Int
  grid        Int
  startOn     DateTime
  createdById String
  guests      Guest[]
  ayahs       Ayah[]
  sprints     Sprint[]
  @@unique([ createdById,souraNb,startOn])

}

model Ayah {
  id  Int    @id @default(autoincrement()) 
  souraNb   Int 
  juz    Int
  order  Int
  text   String
  stages Stage[]
  @@unique([souraNb, order])
}

model Sprint {
  id  Int    @id @default(autoincrement()) 
  sprintId    String  @unique 
  createdAt   DateTime @default(now())
  souraName   String
  souraNb     Int
  grid        Int
  startOn     DateTime
  createdById String
  published   Boolean
  guests      Guest[]
  stages      Stage[]
  @@unique([createdById, souraNb, grid,createdAt])

}
